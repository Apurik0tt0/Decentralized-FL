╭───────────────────────────────────────────────────╮
│     ██████  ████             █████                │
│    ███░░███░░███            ░░███                 │
│   ░███ ░░░  ░███  █████ ████ ░███ █████  ██████   │
│  ███████    ░███ ░░███ ░███  ░███░░███  ███░░███  │
│ ░░░███░     ░███  ░███ ░███  ░██████░  ░███████   │
│   ░███      ░███  ░███ ░███  ░███░░███ ░███░░░    │
│   █████     █████ ░░████████ ████ █████░░██████   │
│  ░░░░░     ░░░░░   ░░░░░░░░ ░░░░ ░░░░░  ░░░░░░    │
╰───────────────────── v0.7.9 ──────────────────────╯
╭───────────────────────────────────────── Configuration ──────────────────────────────────────────╮
│ {                                                                                                │
│     'data': {                                                                                    │
│         'dataset': {                                                                             │
│             'name': 'mnist',                                                                     │
│             'path': './data'                                                                     │
│         },                                                                                       │
│         'distribution': {                                                                        │
│             'name': 'iid'                                                                        │
│         },                                                                                       │
│         'sampling_perc': 1.0,                                                                    │
│         'client_split': 0.2,                                                                     │
│         'keep_test': True,                                                                       │
│         'server_test': True,                                                                     │
│         'server_split': 0.0,                                                                     │
│         'uniform_test': False                                                                    │
│     },                                                                                           │
│     'exp': {                                                                                     │
│         'device': 'cpu',                                                                         │
│         'seed': 42,                                                                              │
│         'inmemory': True                                                                         │
│     },                                                                                           │
│     'eval': {                                                                                    │
│         'task': 'classification',                                                                │
│         'eval_every': 1,                                                                         │
│         'pre_fit': False,                                                                        │
│         'post_fit': True,                                                                        │
│         'locals': False,                                                                         │
│         'server': True                                                                           │
│     },                                                                                           │
│     'logger': {                                                                                  │
│         'name': 'Log',                                                                           │
│         'log_dir': './fluke_results'                                                             │
│     },                                                                                           │
│     'protocol': {                                                                                │
│         'eligible_perc': 0.2,                                                                    │
│         'n_clients': 100,                                                                        │
│         'n_rounds': 5                                                                            │
│     },                                                                                           │
│     'method': {                                                                                  │
│         'hyperparameters': {                                                                     │
│             'client': {                                                                          │
│                 'batch_size': 64,                                                                │
│                 'local_epochs': 10,                                                              │
│                 'loss': 'CrossEntropyLoss',                                                      │
│                 'persistency': True,                                                             │
│                 'optimizer': {                                                                   │
│                     'lr': 0.01,                                                                  │
│                     'momentum': 0.9,                                                             │
│                     'weight_decay': 1e-05,                                                       │
│                     'name': 'SGD'                                                                │
│                 },                                                                               │
│                 'scheduler': {                                                                   │
│                     'gamma': 1,                                                                  │
│                     'step_size': 1,                                                              │
│                     'name': 'StepLR'                                                             │
│                 }                                                                                │
│             },                                                                                   │
│             'server': {                                                                          │
│                 'weighted': True                                                                 │
│             },                                                                                   │
│             'model': 'MNIST_2NN'                                                                 │
│         },                                                                                       │
│         'name': 'fluke.algorithms.fedavg.FedAVG'                                                 │
│     },                                                                                           │
│     'save': {},                                                                                  │
│     'exp_id': 'fe05e2ebc84844efaec3b1ac93e1a9e4'                                                 │
│ }                                                                                                │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
╭────────────────────────────────────────── FL algorithm ──────────────────────────────────────────╮
│ FedAVG[fe05e2ebc84844efaec3b1ac93e1a9e4](                                                        │
│         model=MNIST_2NN(),                                                                       │
│         Client[0-99](                                                                            │
│              optim=OptCfg(SGD,                                                                   │
│                            lr=0.01,                                                              │
│                            momentum=0.9,                                                         │
│                            weight_decay=1e-05,                                                   │
│                            StepLR(gamma=1,                                                       │
│                                   step_size=1)),                                                 │
│              batch_size = 64,                                                                    │
│              loss_fn=CrossEntropyLoss(),                                                         │
│              local_epochs=10,                                                                    │
│              fine_tuning_epochs=0,                                                               │
│              clipping=0),                                                                        │
│         Server(                                                                                  │
│            weighted=True,                                                                        │
│            lr=1.0)                                                                               │
│ )                                                                                                │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────── Round: 1 ────────────────────────────────────────────╮
│ {                                                                                                │
│     'post-fit': {                                                                                │
│         'accuracy': 0.66,                                                                        │
│         'macro_precision': 0.63757,                                                              │
│         'macro_recall': 0.6445,                                                                  │
│         'macro_f1': 0.59964,                                                                     │
│         'micro_precision': 0.66,                                                                 │
│         'micro_recall': 0.66,                                                                    │
│         'micro_f1': 0.66,                                                                        │
│         'support': 20,                                                                           │
│         'round': 1                                                                               │
│     },                                                                                           │
│     'global': {                                                                                  │
│         'accuracy': 0.7257,                                                                      │
│         'macro_precision': 0.75996,                                                              │
│         'macro_recall': 0.7159,                                                                  │
│         'macro_f1': 0.68348,                                                                     │
│         'micro_precision': 0.7257,                                                               │
│         'micro_recall': 0.7257,                                                                  │
│         'micro_f1': 0.7257,                                                                      │
│         'round': 1                                                                               │
│     },                                                                                           │
│     'comm_cost': 7124400                                                                         │
│ }                                                                                                │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
  Memory usage: 1.3 GB [8.28 %]
╭──────────────────────────────────────────── Round: 2 ────────────────────────────────────────────╮
│ {                                                                                                │
│     'post-fit': {                                                                                │
│         'accuracy': 0.8275,                                                                      │
│         'macro_precision': 0.82376,                                                              │
│         'macro_recall': 0.82196,                                                                 │
│         'macro_f1': 0.81432,                                                                     │
│         'micro_precision': 0.8275,                                                               │
│         'micro_recall': 0.8275,                                                                  │
│         'micro_f1': 0.8275,                                                                      │
│         'support': 20,                                                                           │
│         'round': 2                                                                               │
│     },                                                                                           │
│     'global': {                                                                                  │
│         'accuracy': 0.8504,                                                                      │
│         'macro_precision': 0.84839,                                                              │
│         'macro_recall': 0.84771,                                                                 │
│         'macro_f1': 0.84735,                                                                     │
│         'micro_precision': 0.8504,                                                               │
│         'micro_recall': 0.8504,                                                                  │
│         'micro_f1': 0.8504,                                                                      │
│         'round': 2                                                                               │
│     },                                                                                           │
│     'comm_cost': 7124400                                                                         │
│ }                                                                                                │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
  Memory usage: 1.3 GB [8.63 %]
╭──────────────────────────────────────────── Round: 3 ────────────────────────────────────────────╮
│ {                                                                                                │
│     'post-fit': {                                                                                │
│         'accuracy': 0.8625,                                                                      │
│         'macro_precision': 0.86026,                                                              │
│         'macro_recall': 0.86021,                                                                 │
│         'macro_f1': 0.85262,                                                                     │
│         'micro_precision': 0.8625,                                                               │
│         'micro_recall': 0.8625,                                                                  │
│         'micro_f1': 0.8625,                                                                      │
│         'support': 20,                                                                           │
│         'round': 3                                                                               │
│     },                                                                                           │
│     'global': {                                                                                  │
│         'accuracy': 0.8814,                                                                      │
│         'macro_precision': 0.87951,                                                              │
│         'macro_recall': 0.87946,                                                                 │
│         'macro_f1': 0.8791,                                                                      │
│         'micro_precision': 0.8814,                                                               │
│         'micro_recall': 0.8814,                                                                  │
│         'micro_f1': 0.8814,                                                                      │
│         'round': 3                                                                               │
│     },                                                                                           │
│     'comm_cost': 7124400                                                                         │
│ }                                                                                                │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
  Memory usage: 1.4 GB [8.84 %]
╭──────────────────────────────────────────── Round: 4 ────────────────────────────────────────────╮
│ {                                                                                                │
│     'post-fit': {                                                                                │
│         'accuracy': 0.88542,                                                                     │
│         'macro_precision': 0.88704,                                                              │
│         'macro_recall': 0.88648,                                                                 │
│         'macro_f1': 0.88079,                                                                     │
│         'micro_precision': 0.88542,                                                              │
│         'micro_recall': 0.88542,                                                                 │
│         'micro_f1': 0.88542,                                                                     │
│         'support': 20,                                                                           │
│         'round': 4                                                                               │
│     },                                                                                           │
│     'global': {                                                                                  │
│         'accuracy': 0.8976,                                                                      │
│         'macro_precision': 0.89599,                                                              │
│         'macro_recall': 0.89596,                                                                 │
│         'macro_f1': 0.89567,                                                                     │
│         'micro_precision': 0.8976,                                                               │
│         'micro_recall': 0.8976,                                                                  │
│         'micro_f1': 0.8976,                                                                      │
│         'round': 4                                                                               │
│     },                                                                                           │
│     'comm_cost': 7124400                                                                         │
│ }                                                                                                │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
  Memory usage: 1.4 GB [9.15 %]
╭──────────────────────────────────────────── Round: 5 ────────────────────────────────────────────╮
│ {                                                                                                │
│     'post-fit': {                                                                                │
│         'accuracy': 0.89375,                                                                     │
│         'macro_precision': 0.89458,                                                              │
│         'macro_recall': 0.89192,                                                                 │
│         'macro_f1': 0.88795,                                                                     │
│         'micro_precision': 0.89375,                                                              │
│         'micro_recall': 0.89375,                                                                 │
│         'micro_f1': 0.89375,                                                                     │
│         'support': 20,                                                                           │
│         'round': 5                                                                               │
│     },                                                                                           │
│     'global': {                                                                                  │
│         'accuracy': 0.9069,                                                                      │
│         'macro_precision': 0.90557,                                                              │
│         'macro_recall': 0.90545,                                                                 │
│         'macro_f1': 0.90526,                                                                     │
│         'micro_precision': 0.9069,                                                               │
│         'micro_recall': 0.9069,                                                                  │
│         'micro_f1': 0.9069,                                                                      │
│         'round': 5                                                                               │
│     },                                                                                           │
│     'comm_cost': 7124400                                                                         │
│ }                                                                                                │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
  Memory usage: 1.4 GB [9.26 %]

╭────────────────────────────────────── Overall Performance ───────────────────────────────────────╮
│ {                                                                                                │
│     'post-fit': {                                                                                │
│         'accuracy': 0.84751,                                                                     │
│         'macro_precision': 0.84361,                                                              │
│         'macro_recall': 0.84279,                                                                 │
│         'macro_f1': 0.83345,                                                                     │
│         'micro_precision': 0.84751,                                                              │
│         'micro_recall': 0.84751,                                                                 │
│         'micro_f1': 0.84751,                                                                     │
│         'support': 67,                                                                           │
│         'round': 6                                                                               │
│     },                                                                                           │
│     'global': {                                                                                  │
│         'accuracy': 0.9069,                                                                      │
│         'macro_precision': 0.90557,                                                              │
│         'macro_recall': 0.90545,                                                                 │
│         'macro_f1': 0.90526,                                                                     │
│         'micro_precision': 0.9069,                                                               │
│         'micro_recall': 0.9069,                                                                  │
│         'micro_f1': 0.9069,                                                                      │
│         'round': 5                                                                               │
│     },                                                                                           │
│     'comm_costs': 47555370                                                                       │
│ }                                                                                                │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
